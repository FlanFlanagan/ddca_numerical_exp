\documentclass[11pt,letterpaper]{article}
\usepackage[utf8]{inputenc}
\usepackage{caption} % for table captions
\usepackage{amsmath} % for multi-line equations and piecewises
\DeclareMathOperator{\sign}{sign}
\usepackage{graphicx}
\usepackage{relsize}
%\usepackage{textcomp}
\usepackage{xspace}
\usepackage{verbatim} % for block comments
%\usepackage{subfig} % for subfigures
\usepackage{enumitem} % for a) b) c) lists
\newcommand{\Cyclus}{\textsc{Cyclus}\xspace}%
\newcommand{\Cycamore}{\textsc{Cycamore}\xspace}%
\usepackage{tabularx}
\usepackage{color}
\usepackage[acronym,toc]{glossaries}
\include{acros}
\definecolor{bg}{rgb}{0.95,0.95,0.95}
\newcolumntype{b}{X}
\newcolumntype{f}{>{\hsize=.15\hsize}X}
\newcolumntype{s}{>{\hsize=.5\hsize}X}
\newcolumntype{m}{>{\hsize=.75\hsize}X}
\newcolumntype{r}{>{\hsize=1.1\hsize}X}
\usepackage{titling}
\usepackage[hang,flushmargin]{footmisc}
\renewcommand*\footnoterule{}
\usepackage[newfloat]{minted}
\newenvironment{code}{\captionsetup{type=listing}}{}
\SetupFloatingEnvironment{listing}{name=Code}
\newcolumntype{P}[1]{>{\centering\arraybackslash}p{#1}}

\bibliographystyle{abbrv}
\usepackage{tikz}


\usetikzlibrary{shapes.geometric,arrows}
\tikzstyle{process} = [rectangle, rounded corners, minimum width=1cm, minimum height=1cm,text centered, draw=black, fill=blue!30]
\tikzstyle{arrow} = [thick,->,>=stealth]


\graphicspath{{images/}}
\title{Numerical Experiments for Verifying Demand Driven Deployment Algorithms 
        \\ \vspace{0.5em} Non-Optimizing Algorithm}
\author{Jin Whan Bae, Gwendolyn Chee, Kathryn Huff}


\begin{document}
	\maketitle
	\hrule

\section{Introduction}
For many fuel cycle simulations, it is currently up to the user to define
a deployment scheme, or facility parameters, to make sure that there's no gap
in the supply chain. Or, the same goal is achieved by setting the
\texttt{facility} capacity to infinity, which does not reflect real-world
conditions. 

The Demand-Driven Cycamore Archetype project (NEUP-FY16-10512) aims to develop \Cycamore demand-driven deployment capabilities.
The developed algorithm, in the form of \Cyclus \texttt{Institution}
agent, deploys \texttt{Facilities} to meet the front-end and back-end demands of the 
fuel cycle.

This report describes numerical experiments for the non-optimizing algorithm, namely \gls{ARMA} and \gls{ARCH}.

These prediction models are being developed by the University of South Carolina. The numerical experiments will be designed for both
 the once through nuclear fuel 
cycle and advanced fuel cycles. 

\section{Method}
This report lists necessary capabilities of the new \Cyclus \texttt{institution}
for demand-driven deployment of fuel cycle facilities. 
Then the report lists tests to check correct implementation of the capabilities,
with a sample fuel cycle with well-defined facility parameters.


\section{Configuration}
The user defines what prototypes are to be deployed, the initial demand, and the 
growth rate for one of the commodities. For example, if the user
chooses a positive demand growth equation for power, this triggers reactor deployment.
The reactor deployment then causes an increase in the demand of fuel, which triggers fuel facility deployment.
The reactor deployment causes the demand of fuel
which triggers fuel facility deployment. The detailed input file XML input schema
is shown in Appendix A. 

\section{Algorithm Flow}

The algorithm is an \texttt{Institution}, which is a \Cyclus agent type
that deploys and decommissions facilities. 

The algorithm predicts the demand of a commodity by looking at the previous demand and supply values.
This is done through the \texttt{TimeSeries} toolkit in \Cyclus. To implement
this functionality, every \Cycamore archetype is configured to record their
demand and supply whenever they occur (usually, at every \texttt{Tick} or \texttt{Tock},
discussed later). The algorithm accesses this timeseries and makes a prediction to
what the demand will be in the future. If the algorithm sees a lack or excess of supply,
it deploys new facilities or decommissions existing facilities.

\subsection{Autoregressive Moving Average (ARMA)}

\gls{ARMA} is a combination of two models, the Autoregressive
and the Moving Average model. The Autoregressive model 
predicts future values with a linear curve fit of the latest
datasets, and the Moving Average method does so by fitting the 
errors \cite{stine_introduction_2011}.

The model is referred to as ARMA(p,q), where the p and q represent 
the order (number of previous time step values fitted) of the autoregressive,
and the moving average parts,
respectively. 
The \gls{ARMA} model can be represented by the following equation:

\begin{align}
    X_i&=c + \epsilon_t + {\mathlarger{\sum}}_{i=1}^{p}\theta_i \cdot X_{t-i}+
     {\mathlarger{\sum}}_{j=1}^{q}\phi_j\cdot\epsilon_{t-j}\\
    X_i&= \mbox{next predicted value of the time series}\\
    c&= \mbox{adjustable constant}\\
    \theta_i&=i^{th} \mbox{parameter}\\
    \phi_i&=j^{th} \mbox{parameter of the moving average system}\\
    \epsilon &= \mbox{white noise}
\end{align}

\gls{ARMA} is applied to a `well behaved' set of time series data,
where there is little volatility. This makes \gls{ARMA} a suitable
candidate for demand prediction in the case of slowly changing power demand and 
corresponding reactor deployment.


\subsection{Autoregressive Conditional Heteroskedastic (ARCH)}
The \gls{ARCH} model is similar to the \gls{ARMA} model, except that
it uses previous variance terms to calculate current error terms, instead
of the value itself. This allows the model to be used in highly volatile 
time series (e.g. prediction of inflation or stock prices over time 
\cite{bollerslev_generalized_1986}).
The \gls{ARCH} model can be represented by the following equation:

\begin{align}
    \epsilon_t^2 &= \alpha_0+{\mathlarger{\sum}}_{i=1}^{q}\alpha_i\cdot\epsilon_{t-1}^2\\
    \alpha_i&= i^{th} \mbox{parameter of the conditional heteroskedastic model}
\end{align}

A comprehensive fuel cycle simulator must have predictive capabilities which 
can deploy fuel cycle support facilities intelligently even in the face of 
volatile dynamics. Such volatility may arise during transitions between 
technologies, from upsets related to unexpected facility shutdowns, due to the variability 
of an increasingly renewable electric grid, or other nonlinear economic 
drivers.  In these cases, the \gls{ARCH} model is more generically applicable 
and should therefore be preferred over the \gls{ARMA} 
model.

\subsection{Time Step Execution in \Cyclus}
As a reference, the time step execution for \Cyclus is illustrated in figure \ref{diag:time}.

At \texttt{Tock}, the algorithm calculates the demand and supply for the next timestep, and calculates
the difference. If the difference is bigger than the capacity of one facility, it
schedules to deploy a new facility, or a decommissioning of an existing facility.
The decommissioning takes place in the \texttt{Decommission} phase of \Cyclus, and
the construction takes place in the \texttt{Build} phase of \Cyclus. Thus, all the
adjustment of facilities occur prior to the next \gls{DRE}.


\begin{figure}[H]
\centering
\begin{tikzpicture}[node distance=1.5cm]
\node (Build) [process] {Build (kernel)};
\node (Tick) [process, below of=Build] {Tick (agent)};
\node (DRE) [process, below of=Tick]{Dynamic Resource Exchange (kernel) };
\node (Tock) [process, below of=DRE]{Tock (agent)};
\node (Decom) [process, below of=Tock] {Decommission (kernel)};

\draw [arrow] (Build) -- (Tick); 
\draw [arrow] (Tick) -- (DRE);
\draw [arrow] (DRE) -- (Tock);
\draw [arrow] (Tock) -- (Decom);
\end{tikzpicture}
\caption{Each timestep in \Cyclus follows the five steps in order. Processes labeled
         kernel are executed by the \Cyclus framework, whereas processes labeled agent
         are executed by individual agents. What happens in the `Tick' and `Tock' is
         thus unique to each archetype.}
\label{diag:time}
\end{figure}


\section{Simulation parameter for Test Scenarios}
Simple parameters are given to fuel cycle facilities for the numerical testing of 
the algorithm.  Only \texttt{source} and \texttt{reactor} facilities are used in the test scenarios. 

Table \ref{tab:testscenario} provides basic parameters for each test scenario. Table \ref{tab:reactor} provides the parameters for the \texttt{source}, \texttt{reactors} and \texttt{sink} in the test scenarios.

\begin{table}[H]
	\centering
	\caption {Basic Test Parameters}
	\label{tab:testscenario}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Test Scenario Parameters} & \textbf{Value} & \textbf{Units} \\
		\hline
		Duration & 15 & timesteps \\
		Timestep & 1 & month \\
		Start Month & 1 & month \\
		Start Year & 2000 & year \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
    \caption {Source, Reactor and Sink Parameters}
	\label{tab:reactor}
	\begin{tabular}{|l|l|l|}
\hline
\textbf{Source Parameters} & \textbf{Value} & \textbf{Units} \\
\hline
Throughput & 1 & kg \\
Output Commodity & fuel & kg\\
\hline
\textbf{Reactor Parameters} & \textbf{Value} & \textbf{Units} \\
\hline
Cycle Time & 1 & timesteps \\
Refuel Time & 0 & timesteps \\
Lifetime & 1 & timesteps \\
Power Capacity & 1& MWe \\
Assembly Size & 1 & kg \\
\# assemblies per core & 1 & \\
\# assemblies per batch & 1 & \\
Input Commodity & fuel & kg\\
Output Commodity & power & MW\\
\hline
\textbf{Sink Parameters} & \textbf{Value} & \textbf{Units} \\
Throughput & 1 & kg \\
Input Commodity & spent uox & kg\\
\hline
	\end{tabular}
\end{table}

\pagebreak

\section{Numerical Tests for the Non-optimizing prediction method}
The non-optimizing prediction method is tested by comparing its output for various scenarios against their analytical solutions . In this section, the tests that must be met is described based on the parameters defined in table \ref{tab:testscenario} and \ref{tab:reactor} and analytical solution of a defined simple scenario. Unit test examples are included in Appendix B.

The tests are in forms of \texttt{[alphabet]-[traj]-[num]}. \texttt{Alphabet} refers to the supply chain of the test scenario,
\texttt{traj} the demand change in time, and \texttt{num} for tests with the same \texttt{alphabet} and \texttt{traj}.
\begin{itemize}
	\item \textbf{A} - source $\rightarrow$ \texttt{End Demand Commodity}
	\item \textbf{B} - source $\rightarrow$ reactor $\rightarrow$ \texttt{End Demand Commodity}
\end{itemize}

Note that for test C, the \texttt{End Demand Commodity} is power generated from the reactor. The C-tests additionally
check if the sink is deployed to meet spent fuel disposal demand.

The prediction algorithm for the non-optimizing method has three user-defined input parameters. The aim of the various test scenarios are to check if the non-optimizing method archetype will deploy or decommission facilities correctly when there is a variation in the combination of the three input parameters.  The input parameters are: 
\begin{enumerate}
	\item Initial demand value  
	\item Number of initial facilities (initial supply)
	\item Growth rate of initial demand
\end{enumerate}

The growth in demand is governed by the Equation \ref{eq:growth}. 

\begin{align}
\label{eq:growth}
D_f(timestep) &= D_i(1+g)^{(\frac{timestep}{12})}
\end{align}
Where $D_f$ is demand of resource at specific time step, $D_i$ is initial demand and g is growth rate. 

\texttt{Source} and \texttt{reactor} facilities are used in the test scenarios. Test scenarios A1 to A4 and B1 to B2 only have a \texttt{source} facility and test scenarios A5 to A7 have both \texttt{source} and \texttt{reactor} facilities. For each test scenario, there is one table that states the test scenario's input parameters and another table that states the exact analytical solution. The analytical solution table does not include deployment of the initial facility that is stated in the first table.

Additionally, we created base tests for each A-type test scenario that passes when the supply meets the demand within a given facility number tolerance. In other words, when the supply exceeds the demand by the specified tolerance quantity, the test still passes. For this report, the tolerance is set to one facility. For example in test A-1, the expected total number facilities deployed is 1, and since the facility over-prediction tolerance is 1, the acceptable range of total number of facilities $(x)$ deployed in the entire test scenario is $1<x<2$. If the total number of facilities deployed is within this range, the base case test will pass.  

\subsection{Test A-const-1}
In test A-const-1, only a \texttt{source} facility is present in the test scenario. Table \ref{tab:test-A-const-1} shows the input parameters of the source facility in the test scenario. Table \ref{tab:test-A-const-1ana} shows the expected analytical solution based on the test scenario. Table \ref{tab:test-A-const-1base} shows the accepted range of total number of facilities deployed over the test scenario which will pass the base test, which factors in the facility over-prediction tolerance of 1. 
\begin{table}[H]
	\centering
	\caption{Test A-const-1 Scenario Input Parameters }
	\label{tab:test-A-const-1}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Source Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & kg \\
		Initial facilities & 0 & \#\\
		Growth Rate & 0 & \\
\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-const-1 Analytical Solution}
	\label{tab:test-A-const-1ana}
	\begin{tabular}{|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}\\
		\hline
		1 & 1\\
		2 to 15& 0 \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-const-1 Base Test Acceptance}
	\label{tab:test-A-const-1base}
	\begin{tabular}{|P{6.5cm}|}
		\hline
		\textbf{\shortstack{Acceptable total No. of Source \\Facilities Deployed + tolerance}}\\
		\hline
		1 $<$ x $<$ 2 \\
		\hline
	\end{tabular}
\end{table}

\subsection{Test A-const-2}
In test A-const-2, only a \texttt{source} facility is present in the test scenario. Table \ref{tab:test-A-const-2} shows the input parameters of the source facility in the test scenario. Table \ref{tab:test-A-const-2ana} shows the expected analytical solution based on the test scenario.Table \ref{tab:test-A-const-2base} shows the accepted range of total number of facilities deployed over the test scenario which will pass the base test, which factors in the facility over-prediction tolerance of 1. 

\begin{table}[H]
	\centering
	\caption{Test A-const-2 Scenario Input Parameters }
	\label{tab:test-A-const-2}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Source Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 2 & kg \\
		Initial facilities & 1 & \#\\
		Growth Rate & 0 & \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-const-2 Analytical Solution}
	\label{tab:test-A-const-2ana}
	\begin{tabular}{|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}\\
		\hline
		1 & 1\\
		2 to 15& 0 \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-const-2 Base Test Acceptance}
	\label{tab:test-A-const-2base}
	\begin{tabular}{|P{6.5cm}|}
		\hline
		\textbf{\shortstack{Acceptable total No. of Source \\Facilities Deployed + tolerance}}\\
		\hline
		2 $<$ x $<$ 3 \\
		\hline
	\end{tabular}
\end{table}

\subsection{Test A-grow-1}
In test A-grow-1, only a \texttt{source} facility is present in the test scenario. Table \ref{tab:test-A-grow-1} shows the input parameters of the source facility in the test scenario. Table \ref{tab:test-A-grow-1ana} shows the expected analytical solution based on the test scenario. Table \ref{tab:test-A-grow-1base} shows the accepted range of total number of facilities deployed over the test scenario which will pass the base test, which factors in the facility over-prediction tolerance of 1. 

\begin{table}[H]
	\centering
	\caption{Test A-grow-1 Scenario Input Parameters}
	\label{tab:test-A-grow-1}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Source Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & kg \\
		Initial facilities & 0 & \#\\
		Growth Rate & 1 &  \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-grow-1 Analytical Solution}
	\label{tab:test-A-grow-1ana}
	\begin{tabular}{|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}\\
		\hline
		1 & 2\\
		2 to 12 & 0 \\
		13 & 1 \\
		14 to 15 & 0 \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-grow-1 Base Test Acceptance}
	\label{tab:test-A-grow-1base}
	\begin{tabular}{|P{6.5cm}|}
		\hline
		\textbf{\shortstack{Acceptable total No. of Source \\Facilities Deployed + tolerance}}\\
		\hline
		3 $<$ x $<$ 4 \\
		\hline
	\end{tabular}
\end{table}

\subsection{Test A-grow-2}
In test A-grow-2, only a \texttt{source} facility is present in the test scenario. Table \ref{tab:test-A-grow-2} shows the input parameters of the source facility in the test scenario. Table \ref{tab:test-A-grow-2ana} shows the expected analytical solution based on the test scenario. Table \ref{tab:test-A-grow-2base} shows the accepted range of total number of facilities deployed over the test scenario which will pass the base test, which factors in the facility over-prediction tolerance of 1. 

\begin{table}[H]
	\centering
	\caption{Test A-grow-2 Scenario Input Parameters }
	\label{tab:test-A-grow-2}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Source Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & kg \\
		Initial facilities & 1 & \#\\
		Growth Rate & 1 &  \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-grow-2 Analytical Solution}
	\label{tab:test-A-grow-2ana}
	\begin{tabular}{|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}\\
		\hline
		1 & 1\\
		2 to 12 & 0 \\
		13 & 1 \\
		14 to 15 & 0 \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-grow-2 Base Test Acceptance}
	\label{tab:test-A-grow-2base}
	\begin{tabular}{|P{6.5cm}|}
		\hline
		\textbf{\shortstack{Acceptable total No. of Source \\Facilities Deployed + tolerance}}\\
		\hline
		3 $<$ x $<$ 4 \\
		\hline
	\end{tabular}
\end{table}

\subsection{Test B-const-1}
In test B-const-1, both a \texttt{source} and \texttt{reactor} facility is present in the test scenario. Table \ref{tab:test-B-const-1} shows the input parameters of the source facility in the test scenario. Table \ref{tab:test-B-const-1ana} shows the expected analytical solution based on the test scenario. Table \ref{tab:test-B-const-1base} shows the accepted range of total number of facilities deployed over the test scenario which will pass the base test, which factors in the facility over-prediction tolerance of 1. 

\begin{table}[H]
	\centering
	\caption{Test B-const-1 Scenario Input Parameters}
	\label{tab:test-B-const-1}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Source Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & kg \\
		Initial facilities & 0 & \#\\
		Growth Rate & 0 &  \\
		\hline
		\textbf{Reactor Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & MW \\
		Initial facilities & 0 & \#\\
		Growth Rate & 0 &  \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test B-const-1 Analytical Solution}
	\label{tab:test-B-const-1ana}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}} & \textbf{\shortstack{No. of Reactor \\Facilities Deployed}}\\
		\hline
		1 & 1 & 1\\
		2 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test B-const-1 Base Test Acceptance}
	\label{tab:test-B-const-1base}
	\begin{tabular}{|P{6.5cm}|P{6.5cm}|}
		\hline
		\textbf{\shortstack{Acceptable total No. of Source \\Facilities Deployed + tolerance}} &\textbf{\shortstack{Acceptable total No. of Reactor \\Facilities Deployed + tolerance}}\\
		\hline
		1 $<$ x $<$ 2 & 1 $<$ x $<$ 2\\
		\hline
	\end{tabular}
\end{table}

\subsection{Test B-const-2}
In test B-const-2, both a \texttt{source} and \texttt{reactor} facility is present in the test scenario. Table \ref{tab:test-B-const-2} shows the input parameters of the source facility in the test scenario. Table \ref{tab:test-B-const-2ana} shows the expected analytical solution based on the test scenario. Table \ref{tab:test-B-const-2base} shows the accepted range of total number of facilities deployed over the test scenario which will pass the base test, which factors in the facility over-prediction tolerance of 1. 

\begin{table}[H]
	\centering
	\caption{Test B-const-2 Scenario Input Parameters }
	\label{tab:test-B-const-2}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Source Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & kg \\
		Initial facilities & 1 & \#\\
		Growth Rate & 0 &  \\
		\hline
		\textbf{Reactor Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & MW \\
		Initial facilities & 1 & \#\\
		Growth Rate & 0 &  \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test B-const-2 Analytical Solution}
	\label{tab:test-B-const-2ana}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}} & \textbf{\shortstack{No. of Reactor \\Facilities Deployed}}\\
		\hline
		1 & 1 & 1\\
		2 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test B-const-2 Base Test Acceptance}
	\label{tab:test-B-const-2base}
	\begin{tabular}{|P{6.5cm}|P{6.5cm}|}
		\hline
		\textbf{\shortstack{Acceptable total No. of Source \\Facilities Deployed + tolerance}} &\textbf{\shortstack{Acceptable total No. of Reactor \\Facilities Deployed + tolerance}}\\
		\hline
		1 $<$ x $<$ 2 & 1 $<$ x $<$ 2\\
		\hline
	\end{tabular}
\end{table}

\subsection{Test B-grow-1}
In test B-grow-1, both a \texttt{source} and \texttt{reactor} facility is present in the test scenario. Table \ref{tab:test-B-grow-1} shows the input parameters of the source facility in the test scenario. Table \ref{tab:test-B-grow-1ana} shows the expected analytical solution based on the test scenario. Table \ref{tab:test-B-grow-1base} shows the accepted range of total number of facilities deployed over the test scenario which will pass the base test, which factors in the facility over-prediction tolerance of 1. 


\begin{table}[H]
	\centering
	\caption{Test B-grow-1 Scenario Input Parameters }
	\label{tab:test-B-grow-1}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Source Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & kg \\
		Initial facilities & 0 & \#\\
		Growth Rate & 1 &  \\
		\hline
		\textbf{Reactor Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & MW \\
		Initial facilities & 0 & \#\\
		Growth Rate & 1 &  \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test B-grow-1 Analytical Solution}
	\label{tab:testB-grow-1ana}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}} & \textbf{\shortstack{No. of Reactor \\Facilities Deployed}}\\
		\hline
		1 & 2 & 2\\
		2 to 12 & 0 & 0\\
		13 & 1 & 1\\
		14 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test B-grow-1 Base Test Acceptance}
	\label{tab:test-B-grow-1base}
	\begin{tabular}{|P{6.5cm}|P{6.5cm}|}
		\hline
		\textbf{\shortstack{Acceptable total No. of Source \\Facilities Deployed + tolerance}} &\textbf{\shortstack{Acceptable total No. of Reactor \\Facilities Deployed + tolerance}}\\
		\hline
		3 $<$ x $<$ 4 & 3 $<$ x $<$ 4\\
		\hline
	\end{tabular}
\end{table}

\subsection{Test A-const-3}
In test A-const-3, only a \texttt{source} facility is present in the test scenario. Table \ref{tab:test-A-const-3} shows the input parameters of the source facility in the test scenario. Table \ref{tab:test-A-const-3ana} shows the expected analytical solution based on the test scenario. 

\begin{table}[H]
	\centering
	\caption{Test A-const-3 Scenario Input Parameters }
	\label{tab:test-A-const-3}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Source Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 0 & kg \\
		Initial facilities & 1 & \#\\
		Growth Rate & 0 &  \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-const-3 Analytical Solution}
	\label{tab:test-A-const-3ana}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}& \textbf{\shortstack{No. of Source \\Facilities Decomissioned}}\\
		\hline
		1 & 1 & 0\\
		2 & 0 & 1\\
		3 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\subsection{Test A-decl-1}
In test A-decl-1, only a \texttt{source} facility is present in the test scenario. Table \ref{tab:test-A-decl-1} shows the input parameters of the source facility in the test scenario. Table \ref{tab:test-A-decl-1ana} shows the expected analytical solution based on the test scenario.

\begin{table}[H]
	\centering
	\caption{Test A-decl-1 Scenario Input Parameters }
	\label{tab:test-A-decl-1}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Source Parameter} & \textbf{Value} & \textbf{Units} \\
		\hline
		Initial demand & 1 & kg \\
		Initial facilities & 1 & \#\\
		Growth Rate & -1 &  \\
		\hline
	\end{tabular}
\end{table}

\begin{table}[H]
	\centering
	\caption{Test A-decl-1 Analytical Solution}
	\label{tab:test-A-decl-1ana}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}& \textbf{\shortstack{No. of Source \\Facilities Decomissioned}}\\
		\hline
		1 to 12 & 1 & 0\\
		13 & 0 & 1\\
		14 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\section{Numerical Test Results}
It was found that none of the exact tests and base case tests passed. 
The failures are attributed to three reasons:

\begin{enumerate}
	\item There is a test failure when there is no initial facility present. An initial condition must be given for the algorithm to understand the capacity of the facility it deploys.
	\item There is a test failure when there is growth in the demand. The algorithm failed to deploy facilities to meet the increase in demand.
	\item There is a test failure when facilities are expected to be decommissioned. There is yet to be an implementation on decommissioning behavior.
\end{enumerate}

Despite failures in these situations, the non-optimizing method proved to have commissioning capabilities
to meet demand. Because of the limitation in the algorithm, it is hard to predict demand with precision
in such a short time. However, the same numerical experiments can be applied to the deterministic
optimizing algorithm, which holds more promise. The goal is that the deterministic optimization method
will be able to overcome the issues faced by the non-optimizing method with reference to the
requirement of an initial condition, growth in demand. Also, the capability to decommission facilities
upon oversupply will be added.

Appendix C reflects the numerical experiment solution output by the non-optimizing prediction algorithm for each test scenario defined in section 6. 

\pagebreak

\section{References}
\bibliography{bibliography}

\pagebreak

\section*{Appendix A - parameter configuration}
Appendix A shows the json file that contains the simulation parameters that are common between all the test scenarios discussed in Section 6.  

\begin{minted}{json}
template = {
"simulation": {
"archetypes": {
"spec": [
{"lib": "agents", "name": "NullRegion"}, 
{"lib": "cycamore", "name": "Source"}, 
{"lib": "cycamore", "name": "Reactor"},
{"lib": "cycamore", "name": "Sink"},
{"lib": "d3ploy.no_inst", "name": "NOInst"}
]
}, 
"control": {"duration": "15", "startmonth": "1", "startyear": "2000"}, 
"recipe": [
{
"basis": "mass", 
"name": "fresh_uox", 
"nuclide": [{"comp": "0.711", "id": "U235"}, {"comp": "99.289", "id": "U238"}]
}, 
{
"basis": "mass", 
"name": "spent_uox", 
"nuclide": [{"comp": "50", "id": "Kr85"}, {"comp": "50", "id": "Cs137"}]
}
], 
"facility": [{
"config": {"Source": {"outcommod": "fuel",
"outrecipe": "fresh_uox",
"throughput": "1",
"source_record_supply": "fuel"}}, 
"name": "source"
},
{
"config": {"Sink": {"in_commods": {"val":"spent_uox"},
"max_inv_size": 1,
"sink_record_demand": "fuel_cap"}}, 
"name": "sink"
},
{
"config": {
"Reactor":{
"assem_size":"1",
"cycle_time": "1", 
"fuel_incommods": {"val": "fuel"}, 
"fuel_inrecipes": {"val": "fresh_uox"}, 
"fuel_outcommods": {"val": "spent_uox"}, 
"fuel_outrecipes": {"val": "spent_uox"}, 
"n_assem_batch": "1", 
"n_assem_core": "1", 
"power_cap": "1", 
"refuel_time": "0",
"reactor_fuel_demand": "fuel_reactor"
}
},
"name": "reactor"
}]}}
\end{minted}

\pagebreak
\section*{Appendix B - Sample Test Code }
\subsection*{Sample test code for test A-const-1}
Appendix B shows the python file that contains the a segment of the simulation parameters that are unique to test A-const-1 and the code for test A-const-1. 
\begin{minted}{python}
# Test A_const_1
INIT_DEMAND = copy.deepcopy(TEMPLATE)
INIT_DEMAND["simulation"].update({"region": {
"config": {"NullRegion": "\n      "},
"institution": {
"config": {
"NOInst": {
"calc_method": "arma",
"demand_commod": "POWER",
"demand_std_dev": "0.0",
"growth_rate": "0.0",
"initial_demand": "1",
"prototypes": {"val": "source"},
"steps": "1",
"supply_commod": "fuel"
}
},
"name": "source_inst"
},
"name": "SingleRegion"
}})

@pytest.mark.base
def test_a1_init_demand():
# tests if NOInst deploys a source
# given initial demand and no initial facilities
output_file = 'init_file.sqlite'
input_file = output_file.replace('.sqlite', '.json')
with open(input_file, 'w') as f:
json.dump(INIT_DEMAND, f)
s = subprocess.check_output(['cyclus', '-o', output_file, input_file],
universal_newlines=True, env=ENV)
# check if ran successfully
assert("Cyclus run successful!" in s)

# getting the sqlite file
cur = get_cursor(output_file)

# check base solution
source_base = cur.execute(query).fetchone()
assert(1 <= source_base[0] <= (1 + tol))

@pytest.mark.exact
def test_a1_init_demand_exact():
output_file = 'init_file.sqlite'
cur = get_cursor(output_file)
# check exact solution
source_exact = cur.execute(query + " AND EnterTime = 1").fetchone()
assert(source_exact[0] == 1)
\end{minted}

\pagebreak

\section*{Appendix C - Numerical Experiment Solution for test scenarios}
\subsection*{Test A-const-1}
\begin{table}[H]
	\centering
	\caption{Test A-const-1 Numerical Experiment Solution}
	\label{tab:test-A-const-1num}
	\begin{tabular}{|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}\\
		\hline
		1 to 15& 0\\
		\hline
	\end{tabular}
\end{table}

\subsection*{Test A-const-2}
\begin{table}[H]
	\centering
	\caption{Test A-const-2 Numerical Experiment Solution}
	\label{tab:test-A-const-2a2num}
	\begin{tabular}{|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}\\
		\hline
		1 & 0\\
		2 & 1\\
		3 & 1\\
		4 & 1 \\
		5 & 0 \\
		6 & 1 \\
		7 to 15 & 0 \\
		\hline
	\end{tabular}
\end{table}

\subsection*{Test A-grow-1}
\begin{table}[H]
	\centering
	\caption{Test A-grow-1 Numerical Experiment Solution}
	\label{tab:test-A-grow-1num}
	\begin{tabular}{|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}\\
		\hline
		1 to 15& 0\\
		\hline
	\end{tabular}
\end{table}

\subsection*{Test A-grow-2}
\begin{table}[H]
	\centering
	\caption{Test A-grow-2 Numerical Experiment Solution}
	\label{tab:test-A-grow-2num}
	\begin{tabular}{|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}\\
		\hline
		1 to 15& 0\\
		\hline
	\end{tabular}
\end{table}

\subsection*{Test B-const-1}
\begin{table}[H]
	\centering
	\caption{Test B-const-1 Numerical Experiment Solution}
	\label{tab:test-B-const-1num}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}} & \textbf{\shortstack{No. of Reactor \\Facilities Deployed}}\\
		\hline
		1 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\subsection*{Test B-const-2}
\begin{table}[H]
	\centering
	\caption{Test B-const-2 Numerical Experiment Solution}
	\label{tab:test-B-const-2num}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}} & \textbf{\shortstack{No. of Reactor \\Facilities Deployed}}\\
		\hline
		1 & 0 & 0\\
		2 & 1 & 0\\
		3 & 1 & 0\\
		4 & 1 & 0\\
		5 & 0 & 0\\
		6 & 1 & 0\\
		7 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\subsection*{Test B-grow-1}
\begin{table}[H]
	\centering
	\caption{Test B-grow-1 Numerical Experiment Solution}
	\label{tab:test-B-grow-1num}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}} & \textbf{\shortstack{No. of Reactor \\Facilities Deployed}}\\
		\hline
		1 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\subsection*{Test A-const-3}
\begin{table}[H]
	\centering
	\caption{Test A-const-3 Numerical Experiment Solution}
	\label{tab:test-A-const-3num}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}& \textbf{\shortstack{No. of Source \\Facilities Decomissioned}}\\
		\hline
		1 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\subsection*{Test A-decl-1}
\begin{table}[H]
	\centering
	\caption{Test A-decl-1 Numerical Experiment Solution}
	\label{tab:test-A-decl-1num}
	\begin{tabular}{|l|l|l|}
		\hline
		\textbf{Time Step} & \textbf{\shortstack{No. of Source \\Facilities Deployed}}& \textbf{\shortstack{No. of Source \\Facilities Decomissioned}}\\
		\hline
		1 to 15 & 0 & 0\\
		\hline
	\end{tabular}
\end{table}

\end{document}



